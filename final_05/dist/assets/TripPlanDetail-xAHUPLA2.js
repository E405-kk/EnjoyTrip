import{r as u,w as L,o as C,b as g,c as _,x as E,y as z,z as N,S as f,H as V,e as a,i as S,F as M,p as j,g as D,I as F,h as O,t as k,j as R}from"./index-BWaCr9_N.js";const W={id:"map"},A={__name:"VUserPlanMap",props:{stations:Array,selectStation:Object},setup(w){var l,v;const r=u([]),n=u([]),c=u([]),i=u([]),m=w;L(()=>m.selectStation.value,()=>{var e=new kakao.maps.LatLng(m.selectStation.latitude,m.selectStation.longitude);l.panTo(e)},{deep:!0}),C(()=>{if(window.kakao&&window.kakao.maps)h();else{const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=d234049397979f6f3e7cf5e308e8acea&libraries=services,clusterer",e.onload=()=>kakao.maps.load(()=>h()),document.head.appendChild(e)}}),L(()=>m.stations.value,()=>{r.value=[],m.stations.forEach(e=>{let t={};t.latlng=new kakao.maps.LatLng(e.latitude,e.longitude),t.title=e.title,t.contentTypeId=e.contentTypeId,t.firstImage=e.firstImage,t.addr1=e.addr1,t.addr2=e.addr2,t.zipcode=e.zipcode,t.tel=e.tel,t.overview=e.overview,r.value.push(t)}),x()},{deep:!0});const h=()=>{const e=document.getElementById("map"),t={center:new kakao.maps.LatLng(33.450701,126.570667),level:7};l=new kakao.maps.Map(e,t),v=new kakao.maps.MarkerClusterer({map:l,averageCenter:!1,minLevel:7})},x=()=>{b(),y(v);const e=new kakao.maps.Size(25,25);n.value=[],c.value=[],r.value.forEach(s=>{var p="/src/assets/img_marker";p+=s.contentTypeId,p+=".png";const B=new kakao.maps.MarkerImage(p,e),T=new kakao.maps.Marker({map:l,position:s.latlng,title:s.title,clickable:!0,image:B});i.value.push(s.latlng);var I=s.firstImage;I==""&&(I="/src/assets/bg-white.png");var P=`        <div class="mb-10" style="padding: 5px;">           <div> ${s.title} </div>           <img src="${I}" class="m-auto" width="150px" height="auto"/>        <div>${s.addr1}</div> </div>`,$=new kakao.maps.InfoWindow({content:P});c.value.push($),n.value.push(T)});for(let s=0;s<r.value.length;s++)kakao.maps.event.addListener(n.value[s],"mouseover",function(){c.value[s].open(l,n.value[s])}),kakao.maps.event.addListener(n.value[s],"mouseout",function(){c.value[s].close()});v.addMarkers(n.value);const t=r.value.reduce((s,p)=>s.extend(p.latlng),new kakao.maps.LatLngBounds);l.setBounds(t),d()},b=()=>{n.value.length>0&&n.value.forEach(e=>e.setMap(null))};function y(e){e!=null&&e.clear()}var o=null;function d(){o!=null&&o.setMap(null);const e=u([]);for(let t=0;t<i.value.length;t++)e.value.push(i.value[t]);o=new kakao.maps.Polyline({path:e.value,strokeWeight:5,strokeColor:"#2D64F5",strokeOpacity:.7,strokeStyle:"solid"}),o.setMap(l)}return(e,t)=>(g(),_("div",W))}},H=a("div",{class:"my-5 text-center font-semibold text-xl"},"나의 여행 계획",-1),U={class:"fluid-container text-center mt-3 mx-auto w-10/12"},q={class:"bg-white my-5"},G={class:"overflow-x-auto border-x border-t scrollbar",style:{width:"100%","max-height":"500px","overflow-y":"auto"}},J={class:"table-auto w-full"},K=a("thead",{class:"border-b"},[a("tr",{class:"bg-emerald-500 text-white"},[a("th",{class:"text-center p-4 font-medium"},"여행 순서"),a("th",{class:"text-center p-4 font-medium"},"대표이미지"),a("th",{class:"text-center p-4 font-medium"},"관광지명"),a("th",{class:"text-center p-4 font-medium"},"전화번호"),a("th",{class:"text-center p-4 font-medium"},"주소")])],-1),Q={class:"w-full"},X=["onClick"],Y={class:"p-2",style:{width:"100px"}},Z={class:"p-2",style:{width:"70px"}},ee=["src"],te={class:"p-3",style:{width:"200px"}},ae={class:"p-3",style:{width:"180px"}},se={class:"p-3",style:{width:"300px"}},ne={__name:"TripPlanDetail",props:{idx:Number},setup(w){const l=E(),{userInfo:v}=z(l),r=v.value.userId,n=N(),c=u({}),i=u([]),h=Number(w.idx);C(()=>{r||(f.fire("로그인이 필요한 페이지입니다!"),n.push({name:"user-login"})),x()});const x=()=>{V(h,({data:o})=>{i.value=o},o=>{console.log(o)})},b=o=>{c.value=o},y=()=>{f.fire({title:"계획을 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#848484",confirmButtonText:"삭제",cancelButtonText:"취소"}).then(o=>{o.isConfirmed&&F(h,d=>{let e=d.data;d.status==200?(f.fire({title:"계획을 삭제했습니다.",text:"새로운 여행을 계획해보세요!",icon:"success"}),n.push({name:"trip-plan"})):f.fire({icon:"error",text:e})},d=>{console.log(d)})})};return(o,d)=>{const e=O("router-link");return g(),_(M,null,[H,a("div",U,[S(A,{stations:i.value,selectStation:c.value},null,8,["stations","selectStation"]),a("div",q,[a("div",G,[a("table",J,[K,a("tbody",Q,[(g(!0),_(M,null,j(i.value,(t,s)=>(g(),_("tr",{class:"text-center border-b hover:bg-gray-50",key:t.contentId,onClick:p=>b(t)},[a("td",Y,k(s+1),1),a("td",Z,[a("img",{src:t.firstImage},null,8,ee)]),a("td",te,k(t.title),1),a("td",ae,k(t.tel),1),a("td",se,k(t.addr1)+" "+k(t.addr2),1)],8,X))),128))])])])]),a("div",null,[S(e,{class:"ml-4 rounded-xl bg-emerald-500 px-4 py-2 text-base mb-3 font-medium text-white transition duration-200 hover:bg-emerald-400 active:bg-emerald-600",to:{name:"trip-planList"}},{default:D(()=>[R("목록으로 이동")]),_:1}),a("button",{onClick:y,class:"ml-4 rounded-xl bg-red-500 px-4 py-2 text-base mb-3 font-medium text-white transition duration-200 hover:bg-red-400 active:bg-red-600"}," 여행 계획 삭제 ")])])],64)}}};export{ne as default};
