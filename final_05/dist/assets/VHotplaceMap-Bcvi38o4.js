import{x as S,y as L,z as E,N,r as h,w as y,b as p,c as v,e as a,F as U,m as M,v as I,t as V,k as A,S as m,o as R}from"./index-BWaCr9_N.js";import{g as T,r as O,m as z}from"./hotplace-B_1Sabb8.js";const H={class:"min-h-screen ml-10 py-3"},$={class:"border rounded-lg shadow-lg px-6 py-10 max-w-2xl mx-auto bg-grey-lighter"},J={class:"flex"},P={class:"flex-1 space-y-4"},G={class:"w-60 mx-auto flex flex-col items-center justify-center p-3 bg-white text-blue rounded-lg shadow-lg tracking-wide uppercase border border-blue cursor-pointer hover:bg-blue hover:text-white"},K={key:0,style:{width:"60%",height:"auto","aspect-ratio":"4/3","max-width":"100%"}},W=["src"],q=a("svg",{class:"w-10 h-10",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[a("path",{d:"M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z"})],-1),Q=a("span",{class:"mt-2 text-base leading-normal"}," 사진 업로드",-1),X=a("label",{for:"subject",class:"text-lx"},"제목:",-1),Y=a("label",{for:"addr",class:"text-lx"},"주소:",-1),Z={id:"addr",class:"mt-2 outline-none py-2 px-2 text-md border-2 rounded-md w-full"},ee=a("label",{for:"visitDate",class:"text-lx"},"방문 날짜:",-1),te=a("label",{for:"content",class:"block mb-2 text-lg"},"내용:",-1),ae={class:"mt-6 text-center"},ne={__name:"HotplaceFormItem",props:{type:String,latlng:Object,detailAddr:String},setup(k){const _=S(),{userInfo:b}=L(_),d=E(),x=N(),s=k,f=h(!1),c=h(""),e=h({articleNo:0,subject:"",content:"",userId:b.value.userId,userName:"",hit:0,registerTime:"",latitude:0,longitude:0,addr:"",fileInfo:{saveFile:"",saveFolder:"",originalFile:""},img:b.value.img,visitDate:""});if(y(()=>s.detailAddr,o=>{e.value.addr=o},{immediate:!0}),y(()=>s.latlng.lat,()=>{e.value.latitude=s.latlng.lat,e.value.longitude=s.latlng.lng},{immediate:!0}),s.type==="modify"){let{articleno:o}=x.params;T(o,({data:t})=>{e.value=t,console.log(e.value),f.value=!0,B()},t=>{console.log(t)}),f.value=!0}const n=h(""),r=h("");y(()=>e.value.subject,o=>{let t=o.length;t==0||t>30?n.value="제목을 입력해 주세요!":n.value=""},{immediate:!0}),y(()=>e.value.content,o=>{let t=o.length;t==0||t>500?r.value="내용을 입력해 주세요!":r.value=""},{immediate:!0});function w(){n.value?m.fire(n.value):r.value?m.fire(r.value):s.type==="regist"?j():D()}function j(){var o=new FormData,t=document.getElementById("photo");const l=new Blob([JSON.stringify(e.value)],{type:"application/json"}),F={headers:{"Content-Type":"multipart/form-data"}};o.append("file",t.files[0]),o.append("hotplaceDto",l),O(o,F,i=>{let u=i.data;console.log(i),i.status==201?(u="글등록이 완료되었습니다.",m.fire({icon:"success",title:u,showConfirmButton:!1,timer:1500}),g()):m.fire({icon:"error",text:u})},i=>console.log(i))}function D(){var o=new FormData,t=document.getElementById("photo");const l=new Blob([JSON.stringify(e.value)],{type:"application/json"}),F={headers:{"Content-Type":"multipart/form-data"}};o.append("file",t.files[0]),o.append("hotplaceDto",l),z(o,F,i=>{let u="글수정에 실패했습니다.";i.status==200?(u="글이 수정되었습니다.",m.fire({icon:"success",title:u,showConfirmButton:!1,timer:1500})):m.fire({icon:"error",text:u}),g()},i=>console.log(i))}function g(){d.replace({name:"hotplace-list"})}const C=o=>{const t=o.target.files[0];if(t&&t.type.startsWith("image/")){const l=new FileReader;l.readAsDataURL(t),l.onload=()=>{c.value=l.result}}else console.error("이미지 파일을 선택해주세요.")};function B(){if(e.value==null)return null;if(e.value.fileInfo.saveFile){var o="/src/assets/upload/";return o+=e.value.fileInfo.saveFolder+"/"+e.value.fileInfo.saveFile,c.value=o,o}else return c.value="/src/assets/about-bg.jpg","/src/assets/about-bg.jpg"}return(o,t)=>(p(),v("form",null,[a("div",H,[a("div",$,[a("div",J,[a("div",P,[a("label",G,[c.value?(p(),v("div",K,[a("img",{src:c.value,class:"fluid-container",style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,W)])):(p(),v(U,{key:1},[q,Q],64)),a("input",{type:"file",class:"hidden",name:"photo",id:"photo",onChange:C,accept:"image/*"},null,32)]),a("div",null,[X,M(a("input",{type:"text",placeholder:"제목을 입력하세요.",id:"subject","onUpdate:modelValue":t[0]||(t[0]=l=>e.value.subject=l),class:"mt-2 outline-none py-2 px-2 text-md border-2 rounded-md w-full"},null,512),[[I,e.value.subject]])]),a("div",null,[Y,a("div",Z,V(e.value.addr),1)]),a("div",null,[ee,M(a("input",{type:"date",id:"visitDate","onUpdate:modelValue":t[1]||(t[1]=l=>e.value.visitDate=l),class:"mt-2 outline-none py-2 px-2 text-md border-2 rounded-md w-full"},null,512),[[I,e.value.visitDate]])]),a("div",null,[te,M(a("textarea",{id:"content",cols:"10",rows:"5","onUpdate:modelValue":t[2]||(t[2]=l=>e.value.content=l),class:"w-full p-4 text-gray-600 bg-emerald-50 outline-none rounded-md"},null,512),[[I,e.value.content]])])])]),a("div",ae,[k.type==="regist"?(p(),v("button",{key:0,type:"submit",class:"px-6 py-2 mx-auto rounded-md text-lg font-semibold text-emerald-50 bg-emerald-600",onClick:A(w,["prevent"])}," 글작성 ")):(p(),v("button",{key:1,type:"submit",class:"px-6 py-2 mx-auto rounded-md text-lg font-semibold text-emerald-50 bg-emerald-600",onClick:A(w,["prevent"])}," 글수정 ")),a("button",{type:"button",class:"inline-flex px-6 py-2 ml-3 block border rounded-md text-lg font-semibold text-emerald-600 bg-white-100",onClick:g}," 목록으로이동... ")])])])]))}},oe={id:"map",style:{width:"100%",height:"750px"},class:"rounded-lg"},ie={__name:"VHotplaceMap",emits:["pick-place"],setup(k,{emit:_}){const b=_;var d,x,s;R(()=>{if(window.kakao&&window.kakao.maps)f();else{const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=d234049397979f6f3e7cf5e308e8acea&libraries=services,clusterer",e.onload=()=>kakao.maps.load(()=>f()),document.head.appendChild(e)}});const f=()=>{const e=document.getElementById("map"),n={center:new kakao.maps.LatLng(36.386120817951436,128.02537185582057),level:12};d=new kakao.maps.Map(e,n),x=new kakao.maps.services.Geocoder;var r=new kakao.maps.Marker({position:d.getCenter()});r.setMap(d),kakao.maps.event.addListener(d,"click",function(w){s=w.latLng,r.setPosition(s),c(s,function(j,D){if(D===kakao.maps.services.Status.OK){var g=j[0].address.address_name;r.setMap(d),b("pick-place",s,g)}})})};function c(e,n){x.coord2Address(e.getLng(),e.getLat(),n)}return(e,n)=>(p(),v("div",oe))}};export{ne as _,ie as a};
