import{M as Q,x as N,y as j,r as _,b as t,c as n,e as o,t as w,K as f,m as H,v as J,k as G,S as g,i as V,u as A,o as q,F as O,p as W,f as U,N as X,z as ee}from"./index-BWaCr9_N.js";import{d as te,a as oe}from"./board-SuPVdP9M.js";import{_ as ne}from"./VArticle-DP8mS9By.js";import{_ as Y}from"./PageNavigation-DaPBi4z-.js";const M=Q();function se(e,i,a){M.get("/comment/list",{params:e}).then(i).catch(a)}function re(e,i,a){console.log("commentjs article",e),M.post("/comment/regist",JSON.stringify(e)).then(i).catch(a)}function le(e,i,a){M.put("/comment/modify",JSON.stringify(e)).then(i).catch(a)}function ce(e,i,a){M.delete(`/comment/remove/${e}`).then(i).catch(a)}const F=Q();function ie(e,i,a){F.get("/reply/list",{params:e}).then(i).catch(a)}function ae(e,i,a){console.log("replyjs article",e),F.post("/reply/regist",JSON.stringify(e)).then(i).catch(a)}function ue(e,i,a){F.put("/reply/modify",JSON.stringify(e)).then(i).catch(a)}function me(e,i,a){F.delete(`/reply/remove/${e}`).then(i).catch(a)}const de={class:"mt-6 border border-gray-300 rounded-md px-2 relative"},fe={class:"flex items-center",style:{height:"50px"}},ye={key:0,class:"font-semibold ml-1.5 mr-auto"},ge={key:1,class:"font-semibold ml-1.5 mr-auto"},pe={class:"flex items-center justify-between mr-1 ml-auto"},ve={key:1,type:"submit",class:"bg-emerald-100 text-emerald-700 font-semibold py-1 px-2 border border-emerald-300 rounded-md shadow-sm hover:bg-emerald-200 hover:text-emerald-800 focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:ring-opacity-50"},_e={key:2,type:"submit",class:"bg-emerald-100 text-emerald-700 font-semibold py-1 px-2 border border-emerald-300 rounded-md shadow-sm hover:bg-emerald-200 hover:text-emerald-800 focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:ring-opacity-50"},L={__name:"CommentFormItem",props:{type:String,kind:String,parentidx:Number,articleno:Number,curreply:{type:Object,default:()=>({})},curcomment:{type:Object,default:()=>({})}},emits:["write-comment","update-comment","cancel-edit","write-reply","update-reply"],setup(e,{emit:i}){const a=N(),{userInfo:E}=j(a),u=e,p=i,m=_({idx:u.curcomment.idx,articleNo:u.articleno,userId:E.value.userId,content:u.curcomment.content,registerTime:u.curcomment.registerTime,img:E.value.img}),l=_({idx:u.curreply.idx,parentIdx:u.parentidx,userId:E.value.userId,content:u.curreply.content,registerTime:u.curreply.registerTime,img:E.value.img});function S(){u.kind==="comment"?u.type==="regist"?R():b():u.type==="regist"?C():y()}function R(){console.log(m.value),re(m.value,s=>{let c=s.data;s.status==201?(c="댓글이 등록되었습니다.",p("write-comment"),m.value.content="",g.fire({icon:"success",title:c,showConfirmButton:!1,timer:1500})):g.fire({icon:"error",text:c})},s=>console.log(s))}function b(){le(m.value,s=>{let c="댓글 수정에 실패했습니다.";s.status==200?(c="댓글이 수정되었습니다.",p("update-comment",m.value.idx,m.value),g.fire({icon:"success",title:c,showConfirmButton:!1,timer:1500})):g.fire({icon:"error",text:c})},s=>console.log(s))}function C(){console.log(l.value),ae(l.value,s=>{let c=s.data;s.status==201?(c="댓글이 등록되었습니다.",p("write-reply"),l.value.content="",g.fire({icon:"success",title:c,showConfirmButton:!1,timer:1500})):g.fire({icon:"error",text:c})},s=>console.log(s))}function y(){ue(l.value,s=>{let c="댓글 수정에 실패했습니다.";s.status==200?(c="댓글이 수정되었습니다.",p("update-reply",l.value.idx,l.value),g.fire({icon:"success",title:c,showConfirmButton:!1,timer:1500})):g.fire({icon:"error",text:c})},s=>console.log(s))}function h(){p("cancel-edit")}return(s,c)=>(t(),n("form",{onSubmit:G(S,["prevent"])},[o("div",de,[o("div",fe,[e.kind==="comment"?(t(),n("span",ye,w(m.value.userId),1)):f("",!0),e.kind==="reply"?(t(),n("span",ge,w(l.value.userId),1)):f("",!0),o("div",pe,[e.type==="modify"?(t(),n("button",{key:0,class:"text-gray-600 py-1 px-2 hover:text-gray-800",onClick:h}," 취소 ")):f("",!0),e.type==="modify"?(t(),n("button",ve," 수정 ")):f("",!0),e.type==="regist"?(t(),n("button",_e," 등록 ")):f("",!0)])]),e.kind==="comment"?H((t(),n("textarea",{key:0,rows:"3","onUpdate:modelValue":c[0]||(c[0]=T=>m.value.content=T),class:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50",placeholder:"댓글을 입력하세요"},null,512)),[[J,m.value.content]]):f("",!0),e.kind==="reply"?H((t(),n("textarea",{key:1,rows:"3","onUpdate:modelValue":c[1]||(c[1]=T=>l.value.content=T),class:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50",placeholder:"댓글을 입력하세요"},null,512)),[[J,l.value.content]]):f("",!0)])],32))}},he={key:0},xe={key:1,class:"flex items-center mb-2"},be=["src"],Ce={class:"flex-1"},Ie={class:"flex justify-between items-center"},Ee={class:"font-semibold text-gray-700"},ke={key:0},we={class:"text-sm text-gray-500"},Se={class:"text-gray-700"},Re={__name:"ReplyListItem",props:{reply:Object},emits:["update-reply","delete-reply"],setup(e,{emit:i}){const a=N(),{userInfo:E}=j(a),u=e,p=i,m=E.value.userId,l=_(!1),S=(y,h)=>{p("update-reply",y,h),l.value=!1},R=()=>{l.value=!1},b=()=>{p("delete-reply",u.reply.idx)};function C(){if(u.reply.img){var y="/src/assets/users/";return y+=u.reply.img,y}else return"/src/assets/user.png"}return(y,h)=>(t(),n("div",null,[l.value?(t(),n("div",he,[V(L,{curreply:e.reply,type:"modify",kind:"reply",onUpdateReply:S,onCancelEdit:R},null,8,["curreply"])])):f("",!0),l.value?f("",!0):(t(),n("div",xe,[o("img",{class:"w-10 h-10 rounded-full mr-3",src:C(),alt:"User Avatar"},null,8,be),o("div",Ce,[o("div",Ie,[o("span",Ee,w(e.reply.userId),1),e.reply.userId===A(m)?(t(),n("div",ke,[o("button",{class:"text-gray-700 ml-2",onClick:h[0]||(h[0]=s=>l.value=!0)}," 수정 "),o("button",{class:"text-gray-700 ml-2",onClick:b}," 삭제 ")])):f("",!0)]),o("p",we,w(e.reply.registerTime),1),o("p",Se,w(e.reply.content),1)])]))]))}};var Te={VITE_OPEN_API_SERVICE_KEY:"tSOC+TAwUD96Av30HSXD4Sy4Oo/6wkDzPHwtj+DQq/oH+hSIDB1fDJZ1kDvq7QccD2MNB/f0U3As6nbTex+FoQ==",VITE_KAKAO_MAP_SERVICE_KEY:"d234049397979f6f3e7cf5e308e8acea",VITE_VUE_API_URL:"http://localhost:",VITE_SEND_BIRD_APP_ID:"048C350C-CE27-4FFF-82CC-A79585913428",VITE_ARTICLE_LIST_SIZE:"9",VITE_ARTICLE_NAVIGATION_SIZE:"10",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Ae={key:0},$e={key:1,class:"flex items-center mb-2"},De=["src"],Be={class:"flex-1"},Ve={class:"flex justify-between items-center"},Pe={class:"font-semibold text-gray-700"},Oe={class:"flex"},Ue={key:2},Le={class:"text-sm text-gray-500"},Ne={class:"text-gray-700"},je={class:"ml-10 my-4"},Me={key:0},Fe={class:"border-b border-gray-200 pb-4 mb-4"},Ke={__name:"CommentListItem",props:{comment:Object},emits:["update-comment","delete-comment","regist-reply"],setup(e,{emit:i}){const a=N(),{userInfo:E}=j(a),u=e,p=i,m=E.value.userId,l=_(1),S=_(0),{VITE_ARTICLE_LIST_SIZE:R}=Te,b=_({pgno:l.value,spp:R,articleno:0}),C=_(!1),y=_(!1),h=_([]),s=_(!1);q(()=>{b.value.articleno=u.comment.idx});const c=r=>{l.value=r,b.value.pgno=r,D()},T=(r,x)=>{p("update-comment",r,x),C.value=!1},$=()=>{C.value=!1},K=()=>{p("delete-comment",u.comment.idx)};function Z(){if(u.comment.img){var r="/src/assets/users/";return r+=u.comment.img,r}else return"/src/assets/user.png"}const D=()=>{ie(b.value,({data:r})=>{h.value=r.articles,l.value=r.currentPage,S.value=r.totalPageCount,s.value=!0,console.log(r)},r=>{console.log(r)})},P=(r,x)=>{const I=h.value.find(B=>B.idx===r);I&&(I.content=x.content)},d=r=>{g.fire({title:"댓글을 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#848484",confirmButtonText:"삭제",cancelButtonText:"취소"}).then(x=>{x.isConfirmed&&me(r,I=>{let B=I.data;I.status==200?(B="댓글이 삭제되었습니다.",h.value=h.value.filter(z=>z.idx!==r),p("regist-reply"),g.fire({title:"삭제",text:B,icon:"success"})):g.fire({icon:"error",text:B})},I=>{console.log(I)})})},k=()=>{s.value=!1},v=()=>{p("regist-reply"),D()};return(r,x)=>(t(),n("div",null,[C.value?(t(),n("div",Ae,[V(L,{curcomment:e.comment,type:"modify",kind:"comment",onUpdateComment:T,onCancelEdit:$},null,8,["curcomment"])])):f("",!0),C.value?f("",!0):(t(),n("div",$e,[o("img",{class:"w-10 h-10 rounded-full mr-3",src:Z(),alt:"User Avatar"},null,8,De),o("div",Be,[o("div",Ve,[o("span",Pe,w(e.comment.userId),1),o("div",Oe,[y.value?f("",!0):(t(),n("button",{key:0,class:"text-gray-700 ml-2",onClick:x[0]||(x[0]=I=>y.value=!0)}," 댓글 등록 ")),y.value?(t(),n("button",{key:1,class:"text-gray-700 ml-2",onClick:x[1]||(x[1]=I=>y.value=!1)}," 취소 ")):f("",!0),e.comment.userId===A(m)?(t(),n("div",Ue,[o("button",{class:"text-gray-700 ml-2",onClick:x[2]||(x[2]=I=>C.value=!0)}," 수정 "),o("button",{class:"text-gray-700 ml-2",onClick:K}," 삭제 ")])):f("",!0)])]),o("p",Le,w(e.comment.registerTime),1),o("p",Ne,w(e.comment.content),1)])])),o("div",je,[e.comment.reply?(t(),n("div",Me,[s.value?(t(),n(O,{key:1},[o("button",{class:"text-gray-300",onClick:k}," 댓글 숨기기 "),o("div",Fe,[(t(!0),n(O,null,W(h.value,I=>(t(),U(Re,{key:I.idx,reply:I,onUpdateReply:P,onDeleteReply:d},null,8,["reply"]))),128)),V(Y,{"current-page":l.value,"total-page":S.value,onPageChange:c},null,8,["current-page","total-page"])])],64)):(t(),n("button",{key:0,class:"text-emerald-600",onClick:D}," 댓글 보기("+w(e.comment.reply)+") ",1))])):f("",!0),y.value?(t(),n(O,{key:1},[A(m)?(t(),U(L,{key:0,type:"regist",kind:"reply",onWriteReply:v,parentidx:e.comment.idx},null,8,["parentidx"])):f("",!0)],64)):f("",!0)])]))}};var Ze={VITE_OPEN_API_SERVICE_KEY:"tSOC+TAwUD96Av30HSXD4Sy4Oo/6wkDzPHwtj+DQq/oH+hSIDB1fDJZ1kDvq7QccD2MNB/f0U3As6nbTex+FoQ==",VITE_KAKAO_MAP_SERVICE_KEY:"d234049397979f6f3e7cf5e308e8acea",VITE_VUE_API_URL:"http://localhost:",VITE_SEND_BIRD_APP_ID:"048C350C-CE27-4FFF-82CC-A79585913428",VITE_ARTICLE_LIST_SIZE:"9",VITE_ARTICLE_NAVIGATION_SIZE:"10",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const He={class:"container mx-auto p-5"},Je={class:"flex justify-center"},Qe={class:"w-full lg:w-10/12 text-start bg-white shadow-md rounded-lg p-5"},qe=o("div",{class:"border-t my-3"},null,-1),We={class:"flex justify-between mt-10"},Ye={class:"flex"},ze={class:"bg-white shadow-md rounded-lg p-5 mt-5"},Ge={class:"text-xl font-semibold text-gray-800 mb-4"},Xe={class:"border-b border-gray-200 pb-4 mb-4"},et={key:0,class:"text-gray-500"},rt={__name:"BoardDetail",setup(e){const i=N(),{userInfo:a}=j(i),E=a.value.userId,u=X(),p=ee(),m=_([]),l=_(1),S=_(0),{VITE_ARTICLE_LIST_SIZE:R}=Ze,{articleno:b}=u.params,C=_({pgno:l.value,spp:R,articleno:0}),y=_({});q(()=>{h()});const h=()=>{te(b,({data:d})=>{y.value=d,C.value.articleno=b,$()},d=>{console.log(d)})};function s(){p.push({name:"article-list"})}function c(){p.push({name:"article-modify",params:{articleno:b}})}function T(){g.fire({title:"게시글을 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#848484",confirmButtonText:"삭제",cancelButtonText:"취소"}).then(d=>{d.isConfirmed&&oe(b,k=>{let v=k.data;k.status==200?(v="게시글이 삭제되었습니다.",g.fire({title:"삭제",text:v,icon:"success"}),s()):g.fire({icon:"error",text:v})},k=>{console.log(k)})})}const $=()=>{se(C.value,({data:d})=>{m.value=d.articles,l.value=d.currentPage,S.value=d.totalPageCount},d=>{console.log(d)})},K=d=>{l.value=d,C.value.pgno=d,$()},Z=(d,k)=>{const v=m.value.find(r=>r.idx===d);v&&(v.content=k.content)},D=d=>{g.fire({title:"댓글을 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#848484",confirmButtonText:"삭제",cancelButtonText:"취소"}).then(k=>{k.isConfirmed&&ce(d,v=>{let r=v.data;v.status==200?(r="댓글이 삭제되었습니다.",m.value=m.value.filter(x=>x.idx!==d),g.fire({title:"삭제",text:r,icon:"success"})):g.fire({icon:"error",text:r})},v=>{console.log(v)})})},P=()=>{$()};return(d,k)=>(t(),n("div",He,[o("div",Je,[o("div",Qe,[V(ne,{article:y.value},null,8,["article"]),qe,o("div",We,[o("button",{type:"button",class:"bg-gray-100 text-gray-700 font-semibold py-2 px-4 border border-gray-300 rounded-md shadow-sm hover:bg-gray-200 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50",onClick:s}," 글목록 "),o("div",Ye,[A(E)===y.value.userId?(t(),n("button",{key:0,type:"button",class:"mr-3 bg-emerald-100 text-emerald-700 font-semibold py-2 px-4 border border-emerald-300 rounded-md shadow-sm hover:bg-emerald-200 hover:text-emerald-800 focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:ring-opacity-50",onClick:c}," 글수정 ")):f("",!0),A(E)===y.value.userId?(t(),n("button",{key:1,type:"button",class:"bg-red-100 text-red-700 font-semibold py-2 px-4 border border-red-300 rounded-md shadow-sm hover:bg-red-200 hover:text-red-800 focus:outline-none focus:ring-2 focus:ring-red-300 focus:ring-opacity-50",onClick:T}," 글삭제 ")):f("",!0)])]),o("div",ze,[o("h3",Ge," 댓글 ("+w(m.value.length)+") ",1),o("div",Xe,[(t(!0),n(O,null,W(m.value,v=>(t(),U(Ke,{key:v.idx,comment:v,onUpdateComment:Z,onRegistReply:P,onDeleteComment:D},null,8,["comment"]))),128))]),m.value.length===0?(t(),n("div",et," 댓글이 없습니다. ")):f("",!0),V(Y,{"current-page":l.value,"total-page":S.value,onPageChange:K},null,8,["current-page","total-page"]),A(E)?(t(),U(L,{key:1,type:"regist",kind:"comment",onWriteComment:P,articleno:A(b)},null,8,["articleno"])):f("",!0)])])])]))}};export{rt as default};
