import{M as L,H as O,I as U,r as b,b as a,c as d,e,t as w,K as _,m as M,v as j,k as F,S as g,i as k,u as I,N as K,x as H,o as Z,F as J,p as Q,f as A}from"./index-CmhezA2U.js";import{d as q,a as W}from"./board-DkxEk9Zx.js";import{_ as Y}from"./VArticle-3rM-Qc7_.js";import{_ as z}from"./PageNavigation-tD9agCXi.js";const E=L();function G(t,s,r){E.get("/comment/list",{params:t}).then(s).catch(r)}function X(t,s,r){console.log("commentjs article",t),E.post("/comment/regist",JSON.stringify(t)).then(s).catch(r)}function ee(t,s,r){E.put("/comment/modify",JSON.stringify(t)).then(s).catch(r)}function te(t,s,r){E.delete(`/comment/remove/${t}`).then(s).catch(r)}const oe={class:"mt-6 border border-gray-300 rounded-md px-2 relative"},ne={class:"flex items-center",style:{height:"50px"}},se={class:"font-semibold ml-1.5 mr-auto"},re={class:"flex items-center justify-between mr-1 ml-auto"},ce={key:1,type:"submit",class:"bg-emerald-100 text-emerald-700 font-semibold py-1 px-2 border border-emerald-300 rounded-md shadow-sm hover:bg-emerald-200 hover:text-emerald-800 focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:ring-opacity-50"},ae={key:2,type:"submit",class:"bg-emerald-100 text-emerald-700 font-semibold py-1 px-2 border border-emerald-300 rounded-md shadow-sm hover:bg-emerald-200 hover:text-emerald-800 focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:ring-opacity-50"},B={__name:"CommentFormItem",props:{type:String,articleno:Number,curcomment:{type:Object,default:()=>({})}},emits:["write-comment","update-comment","cancel-edit"],setup(t,{emit:s}){const r=O(),{userInfo:p}=U(r),c=t,i=s,l=b({idx:c.curcomment.idx,articleNo:c.articleno,userId:sessionStorage.getItem("userId"),content:c.curcomment.content,registerTime:c.curcomment.registerTime,img:p.value.img});function x(){c.type==="regist"?v():y()}function v(){console.log(l.value),X(l.value,n=>{let m=n.data;n.status==201?(m="댓글이 등록되었습니다.",i("write-comment"),l.value.content="",g.fire({icon:"success",title:m,showConfirmButton:!1,timer:1500})):g.fire({icon:"error",text:m})},n=>console.log(n))}function y(){ee(l.value,n=>{let m="댓글 수정에 실패했습니다.";n.status==200?(m="댓글이 수정되었습니다.",i("update-comment",l.value.idx,l.value),g.fire({icon:"success",title:m,showConfirmButton:!1,timer:1500})):g.fire({icon:"error",text:m})},n=>console.log(n))}function f(){i("cancel-edit")}return(n,m)=>(a(),d("form",{onSubmit:F(x,["prevent"])},[e("div",oe,[e("div",ne,[e("span",se,w(l.value.userId),1),e("div",re,[t.type==="modify"?(a(),d("button",{key:0,class:"text-gray-600 py-1 px-2 hover:text-gray-800",onClick:f}," 취소 ")):_("",!0),t.type==="modify"?(a(),d("button",ce," 수정 ")):_("",!0),t.type==="regist"?(a(),d("button",ae," 등록 ")):_("",!0)])]),M(e("textarea",{rows:"3","onUpdate:modelValue":m[0]||(m[0]=S=>l.value.content=S),class:"w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50",placeholder:"댓글을 입력하세요"},null,512),[[j,l.value.content]])])],32))}},ie={key:0},le={key:1,class:"flex items-center mb-2"},me=["src"],ue={class:"flex-1"},de={class:"flex justify-between items-center"},fe={class:"font-semibold text-gray-700"},ge={key:0},_e={class:"text-sm text-gray-500"},ve={class:"text-gray-700"},he={__name:"CommentListItem",props:{comment:Object},emits:["update-comment","delete-comment"],setup(t,{emit:s}){const r=t,p=s,c=sessionStorage.getItem("userId"),i=b(!1),l=(f,n)=>{p("update-comment",f,n),i.value=!1},x=()=>{i.value=!1},v=()=>{p("delete-comment",r.comment.idx)};function y(){if(r.comment.img){var f="/src/assets/users/";return f+=r.comment.img,f}else return"/src/assets/user.png"}return(f,n)=>(a(),d("div",null,[i.value?(a(),d("div",ie,[k(B,{curcomment:t.comment,type:"modify",onUpdateComment:l,onCancelEdit:x},null,8,["curcomment"])])):_("",!0),i.value?_("",!0):(a(),d("div",le,[e("img",{class:"w-10 h-10 rounded-full mr-3",src:y(),alt:"User Avatar"},null,8,me),e("div",ue,[e("div",de,[e("span",fe,w(t.comment.userId),1),t.comment.userId===I(c)?(a(),d("div",ge,[e("button",{class:"text-gray-700 ml-2",onClick:n[0]||(n[0]=m=>i.value=!0)}," 수정 "),e("button",{class:"text-gray-700 ml-2",onClick:v}," 삭제 ")])):_("",!0)]),e("p",_e,w(t.comment.registerTime),1),e("p",ve,w(t.comment.content),1)])]))]))}};var pe={VITE_OPEN_API_SERVICE_KEY:"tSOC+TAwUD96Av30HSXD4Sy4Oo/6wkDzPHwtj+DQq/oH+hSIDB1fDJZ1kDvq7QccD2MNB/f0U3As6nbTex+FoQ==",VITE_KAKAO_MAP_SERVICE_KEY:"d234049397979f6f3e7cf5e308e8acea",VITE_VUE_API_URL:"http://localhost:",VITE_SEND_BIRD_APP_ID:"048C350C-CE27-4FFF-82CC-A79585913428",VITE_ARTICLE_LIST_SIZE:"9",VITE_ARTICLE_NAVIGATION_SIZE:"10",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const ye={class:"container mx-auto p-5"},be={class:"flex justify-center"},xe={class:"w-full lg:w-10/12 text-start bg-white shadow-md rounded-lg p-5"},Ce=e("div",{class:"border-t my-3"},null,-1),Ie={class:"flex justify-between mt-10"},we={class:"flex"},Ee={class:"bg-white shadow-md rounded-lg p-5 mt-5"},Se={class:"text-xl font-semibold text-gray-800 mb-4"},Te={class:"border-b border-gray-200 pb-4 mb-4"},ke={key:0,class:"text-gray-500"},Ve={__name:"BoardDetail",setup(t){const s=sessionStorage.getItem("userId"),r=K(),p=H(),c=b([]),i=b(1),l=b(0),{VITE_ARTICLE_LIST_SIZE:x}=pe,{articleno:v}=r.params,y=b({pgno:i.value,spp:x,articleno:0}),f=b({});Z(()=>{n()});const n=()=>{q(v,({data:o})=>{f.value=o,y.value.articleno=v,T()},o=>{console.log(o)})};function m(){p.push({name:"article-list"})}function S(){p.push({name:"article-modify",params:{articleno:v}})}function $(){g.fire({title:"게시글을 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#848484",confirmButtonText:"삭제",cancelButtonText:"취소"}).then(o=>{o.isConfirmed&&W(v,h=>{let u=h.data;h.status==200?(u="게시글이 삭제되었습니다.",g.fire({title:"삭제",text:u,icon:"success"}),m()):g.fire({icon:"error",text:u})},h=>{console.log(h)})})}const T=()=>{G(y.value,({data:o})=>{c.value=o.articles,i.value=o.currentPage,l.value=o.totalPageCount},o=>{console.log(o)})},D=o=>{i.value=o,y.value.pgno=o,T()},V=(o,h)=>{const u=c.value.find(C=>C.idx===o);u&&(u.content=h.content)},N=o=>{g.fire({title:"댓글을 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#848484",confirmButtonText:"삭제",cancelButtonText:"취소"}).then(h=>{h.isConfirmed&&te(o,u=>{let C=u.data;u.status==200?(C="댓글이 삭제되었습니다.",c.value=c.value.filter(R=>R.idx!==o),g.fire({title:"삭제",text:C,icon:"success"})):g.fire({icon:"error",text:C})},u=>{console.log(u)})})},P=()=>{T()};return(o,h)=>(a(),d("div",ye,[e("div",be,[e("div",xe,[k(Y,{article:f.value},null,8,["article"]),Ce,e("div",Ie,[e("button",{type:"button",class:"bg-gray-100 text-gray-700 font-semibold py-2 px-4 border border-gray-300 rounded-md shadow-sm hover:bg-gray-200 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50",onClick:m}," 글목록 "),e("div",we,[I(s)===f.value.userId?(a(),d("button",{key:0,type:"button",class:"mr-3 bg-emerald-100 text-emerald-700 font-semibold py-2 px-4 border border-emerald-300 rounded-md shadow-sm hover:bg-emerald-200 hover:text-emerald-800 focus:outline-none focus:ring-2 focus:ring-emerald-300 focus:ring-opacity-50",onClick:S}," 글수정 ")):_("",!0),I(s)===f.value.userId?(a(),d("button",{key:1,type:"button",class:"bg-red-100 text-red-700 font-semibold py-2 px-4 border border-red-300 rounded-md shadow-sm hover:bg-red-200 hover:text-red-800 focus:outline-none focus:ring-2 focus:ring-red-300 focus:ring-opacity-50",onClick:$}," 글삭제 ")):_("",!0)])]),e("div",Ee,[e("h3",Se," 댓글 ("+w(c.value.length)+") ",1),e("div",Te,[(a(!0),d(J,null,Q(c.value,u=>(a(),A(he,{key:u.idx,comment:u,onUpdateComment:V,onDeleteComment:N},null,8,["comment"]))),128))]),c.value.length===0?(a(),d("div",ke," 댓글이 없습니다. ")):_("",!0),k(z,{"current-page":i.value,"total-page":l.value,onPageChange:D},null,8,["current-page","total-page"]),I(s)?(a(),A(B,{key:1,type:"regist",onWriteComment:P,articleno:I(v)},null,8,["articleno"])):_("",!0)])])])]))}};export{Ve as default};
