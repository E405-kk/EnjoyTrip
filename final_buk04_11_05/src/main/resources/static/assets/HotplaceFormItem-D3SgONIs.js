import{H as M,I as N,x as E,N as R,r as c,w as y,b as u,c as d,e as o,F as T,m as w,v as _,k as I,S as r}from"./index-CmhezA2U.js";import{g as U,r as V,m as H}from"./hotplace-DA5ra_re.js";const z={class:"min-h-screen md:px-20 pt-6"},J={class:"border rounded-lg shadow-lg px-6 py-10 max-w-2xl mx-auto bg-grey-lighter"},L={class:"flex"},O={class:"w-60 mr-6 flex flex-col items-center justify-center px-4 py-6 bg-white text-blue rounded-lg shadow-lg tracking-wide uppercase border border-blue cursor-pointer hover:bg-blue hover:text-white"},P={key:0},W=["src"],q=o("svg",{class:"w-10 h-10",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[o("path",{d:"M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z"})],-1),G=o("span",{class:"mt-2 text-base leading-normal"}," 사진 업로드",-1),K={class:"flex-1 space-y-4"},Q=o("label",{for:"subject",class:"text-lx"},"제목:",-1),X=o("label",{for:"content",class:"block mb-2 text-lg"},"내용:",-1),Y={class:"mt-6 text-center"},ee={__name:"HotplaceFormItem",props:{type:String},setup(v){const F=M(),{userInfo:k}=N(F),j=E(),B=R(),b=v,h=c(!1),i=c(""),l=c({articleNo:0,subject:"",content:"",userId:sessionStorage.getItem("userId"),userName:"",hit:0,registerTime:"",fileInfo:{saveFile:"",saveFolder:"",originalFile:""},img:k.value.img});if(b.type==="modify"){let{articleno:t}=B.params;U(t,({data:e})=>{l.value=e,h.value=!0,D()},e=>{console.log(e)}),h.value=!0}const m=c(""),p=c("");y(()=>l.value.subject,t=>{let e=t.length;e==0||e>30?m.value="제목을 입력해 주세요!":m.value=""},{immediate:!0}),y(()=>l.value.content,t=>{let e=t.length;e==0||e>500?p.value="내용을 입력해 주세요!":p.value=""},{immediate:!0});function x(){m.value?r.fire(m.value):p.value?r.fire(p.value):b.type==="regist"?C():S()}function C(){var t=new FormData,e=document.getElementById("photo");const s=new Blob([JSON.stringify(l.value)],{type:"application/json"}),g={headers:{"Content-Type":"multipart/form-data"}};t.append("file",e.files[0]),t.append("hotplaceDto",s),V(t,g,a=>{let n=a.data;console.log(a),a.status==201?(n="글등록이 완료되었습니다.",r.fire({icon:"success",title:n,showConfirmButton:!1,timer:1500}),f()):r.fire({icon:"error",text:n})},a=>console.log(a))}function S(){var t=new FormData,e=document.getElementById("photo");const s=new Blob([JSON.stringify(l.value)],{type:"application/json"}),g={headers:{"Content-Type":"multipart/form-data"}};t.append("file",e.files[0]),t.append("hotplaceDto",s),H(t,g,a=>{let n="글수정에 실패했습니다.";a.status==200?(n="글이 수정되었습니다.",r.fire({icon:"success",title:n,showConfirmButton:!1,timer:1500})):r.fire({icon:"error",text:n}),f()},a=>console.log(a))}function f(){j.replace({name:"hotplace-list"})}const A=t=>{const e=t.target.files[0];if(e&&e.type.startsWith("image/")){const s=new FileReader;s.readAsDataURL(e),s.onload=()=>{i.value=s.result}}else console.error("이미지 파일을 선택해주세요.")};function D(){if(l.value==null)return null;if(l.value.fileInfo.saveFile){var t="/src/assets/upload/";return t+=l.value.fileInfo.saveFolder+"/"+l.value.fileInfo.saveFile,i.value=t,t}else return i.value="/src/assets/about-bg.jpg","/src/assets/about-bg.jpg"}return(t,e)=>(u(),d("form",null,[o("div",z,[o("div",J,[o("div",L,[o("label",O,[i.value?(u(),d("div",P,[o("img",{src:i.value,class:"fluid-container"},null,8,W)])):(u(),d(T,{key:1},[q,G],64)),o("input",{type:"file",class:"hidden",name:"photo",id:"photo",onChange:A,accept:"image/*"},null,32)]),o("div",K,[o("div",null,[Q,w(o("input",{type:"text",placeholder:"제목을 입력하세요.",id:"subject","onUpdate:modelValue":e[0]||(e[0]=s=>l.value.subject=s),class:"mt-2 outline-none py-2 px-2 text-md border-2 rounded-md w-full"},null,512),[[_,l.value.subject]])]),o("div",null,[X,w(o("textarea",{id:"content",cols:"30",rows:"10","onUpdate:modelValue":e[1]||(e[1]=s=>l.value.content=s),class:"w-full p-4 text-gray-600 bg-emerald-50 outline-none rounded-md"},null,512),[[_,l.value.content]])])])]),o("div",Y,[v.type==="regist"?(u(),d("button",{key:0,type:"submit",class:"px-6 py-2 mx-auto rounded-md text-lg font-semibold text-emerald-50 bg-emerald-600",onClick:I(x,["prevent"])}," 글작성 ")):(u(),d("button",{key:1,type:"submit",class:"px-6 py-2 mx-auto rounded-md text-lg font-semibold text-emerald-50 bg-emerald-600",onClick:I(x,["prevent"])}," 글수정 ")),o("button",{type:"button",class:"inline-flex px-6 py-2 ml-3 block border rounded-md text-lg font-semibold text-emerald-600 bg-white-100",onClick:f}," 목록으로이동... ")])])])]))}};export{ee as _};
