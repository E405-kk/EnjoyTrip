import{r as m,w as I,o as M,b as w,c as x,x as $,S as _,E as N,e as t,i as S,F as C,p as V,g as j,G as z,h as D,t as g,j as F}from"./index-CmhezA2U.js";const O={id:"map"},W={__name:"VUserPlanMap",props:{stations:Array,selectStation:Object},setup(b){var n,p;const r=m([]),i=m([]),c=m([]),v=m([]),d=b;I(()=>d.selectStation.value,()=>{var e=new kakao.maps.LatLng(d.selectStation.latitude,d.selectStation.longitude);n.panTo(e)},{deep:!0}),M(()=>{if(window.kakao&&window.kakao.maps)f();else{const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=d234049397979f6f3e7cf5e308e8acea&libraries=services,clusterer",e.onload=()=>kakao.maps.load(()=>f()),document.head.appendChild(e)}}),I(()=>d.stations.value,()=>{r.value=[],d.stations.forEach(e=>{let a={};a.latlng=new kakao.maps.LatLng(e.latitude,e.longitude),a.title=e.title,a.contentTypeId=e.contentTypeId,a.firstImage=e.firstImage,a.addr1=e.addr1,a.addr2=e.addr2,a.zipcode=e.zipcode,a.tel=e.tel,a.overview=e.overview,r.value.push(a)}),l()},{deep:!0});const f=()=>{const e=document.getElementById("map"),a={center:new kakao.maps.LatLng(33.450701,126.570667),level:7};n=new kakao.maps.Map(e,a),p=new kakao.maps.MarkerClusterer({map:n,averageCenter:!1,minLevel:7})},l=()=>{u(),h(p);const e=new kakao.maps.Size(25,25);i.value=[],c.value=[],r.value.forEach(s=>{var k="/src/assets/img_marker";k+=s.contentTypeId,k+=".png";const B=new kakao.maps.MarkerImage(k,e),P=new kakao.maps.Marker({map:n,position:s.latlng,title:s.title,clickable:!0,image:B});v.value.push(s.latlng);var L=s.firstImage;L==""&&(L="/src/assets/bg-white.png");var T=`        <div class="mb-10" style="padding: 5px;">           <div> ${s.title} </div>           <img src="${L}" class="m-auto" width="150px" height="auto"/>        <div>${s.addr1}</div> </div>`,E=new kakao.maps.InfoWindow({content:T});c.value.push(E),i.value.push(P)});for(let s=0;s<r.value.length;s++)kakao.maps.event.addListener(i.value[s],"mouseover",function(){c.value[s].open(n,i.value[s])}),kakao.maps.event.addListener(i.value[s],"mouseout",function(){c.value[s].close()});p.addMarkers(i.value);const a=r.value.reduce((s,k)=>s.extend(k.latlng),new kakao.maps.LatLngBounds);n.setBounds(a),y()},u=()=>{i.value.length>0&&i.value.forEach(e=>e.setMap(null))};function h(e){e!=null&&e.clear()}var o=null;function y(){o!=null&&o.setMap(null);const e=m([]);for(let a=0;a<v.value.length;a++)e.value.push(v.value[a]);o=new kakao.maps.Polyline({path:e.value,strokeWeight:5,strokeColor:"#2D64F5",strokeOpacity:.7,strokeStyle:"solid"}),o.setMap(n)}return(e,a)=>(w(),x("div",O))}},A=t("div",{class:"my-5 text-center font-semibold text-xl"},"나의 여행 계획",-1),G={class:"fluid-container text-center mt-3 mx-auto w-10/12"},R={class:"bg-white my-5"},U={class:"overflow-x-auto border-x border-t scrollbar",style:{width:"100%","max-height":"500px","overflow-y":"auto"}},q={class:"table-auto w-full"},H=t("thead",{class:"border-b"},[t("tr",{class:"bg-emerald-500 text-white"},[t("th",{class:"text-center p-4 font-medium"},"여행 순서"),t("th",{class:"text-center p-4 font-medium"},"대표이미지"),t("th",{class:"text-center p-4 font-medium"},"관광지명"),t("th",{class:"text-center p-4 font-medium"},"전화번호"),t("th",{class:"text-center p-4 font-medium"},"주소")])],-1),J={class:"w-full"},K=["onClick"],Q={class:"p-2",style:{width:"100px"}},X={class:"p-2",style:{width:"70px"}},Y=["src"],Z={class:"p-3",style:{width:"200px"}},ee={class:"p-3",style:{width:"180px"}},te={class:"p-3",style:{width:"300px"}},se={__name:"TripPlanDetail",props:{idx:Number},setup(b){const n=$(),p=m({}),r=m([]),c=Number(b.idx);M(()=>{sessionStorage.getItem("userId")==null&&(_.fire("로그인이 필요한 페이지입니다!"),n.push({name:"user-login"})),v()});const v=()=>{N(c,({data:l})=>{r.value=l},l=>{console.log(l)})},d=l=>{p.value=l},f=()=>{_.fire({title:"계획을 삭제하시겠습니까?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#848484",confirmButtonText:"삭제",cancelButtonText:"취소"}).then(l=>{l.isConfirmed&&z(c,u=>{let h=u.data;u.status==200?(_.fire({title:"계획을 삭제했습니다.",text:"새로운 여행을 계획해보세요!",icon:"success"}),n.push({name:"trip-plan"})):_.fire({icon:"error",text:h})},u=>{console.log(u)})})};return(l,u)=>{const h=D("router-link");return w(),x(C,null,[A,t("div",G,[S(W,{stations:r.value,selectStation:p.value},null,8,["stations","selectStation"]),t("div",R,[t("div",U,[t("table",q,[H,t("tbody",J,[(w(!0),x(C,null,V(r.value,(o,y)=>(w(),x("tr",{class:"text-center border-b hover:bg-gray-50",key:o.contentId,onClick:e=>d(o)},[t("td",Q,g(y+1),1),t("td",X,[t("img",{src:o.firstImage},null,8,Y)]),t("td",Z,g(o.title),1),t("td",ee,g(o.tel),1),t("td",te,g(o.addr1)+" "+g(o.addr2),1)],8,K))),128))])])])]),t("div",null,[S(h,{class:"ml-4 rounded-xl bg-emerald-500 px-4 py-2 text-base mb-3 font-medium text-white transition duration-200 hover:bg-emerald-400 active:bg-emerald-600",to:{name:"trip-planList"}},{default:j(()=>[F("목록으로 이동")]),_:1}),t("button",{onClick:f,class:"ml-4 rounded-xl bg-red-500 px-4 py-2 text-base mb-3 font-medium text-white transition duration-200 hover:bg-red-400 active:bg-red-600"}," 여행 계획 삭제 ")])])],64)}}};export{se as default};
